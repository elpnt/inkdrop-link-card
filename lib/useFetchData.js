"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.useFetchData=useFetchData;var _react=require("react");var _openGraphScraper=_interopRequireDefault(require("open-graph-scraper"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}const parser=new DOMParser();const FETCH_DELAY=500;function useFetchData(href){const[image,setImage]=(0,_react).useState("");const[title,setTitle]=(0,_react).useState("");const[description,setDescription]=(0,_react).useState("");(0,_react).useEffect(()=>{const timer=setTimeout(async()=>{const response=await fetch(href);const html=await response.text();const{result}=await (0,_openGraphScraper).default({html});const{ogImage,ogTitle,ogDescription,twitterImage,twitterTitle,twitterDescription}=result;const document=parser.parseFromString(html,"text/html");setTitle(document.title||ogTitle||twitterTitle||href);setDescription(ogDescription||twitterDescription||"");const imageRawUrl=ogImage?.url||twitterImage?.url;if(imageRawUrl===undefined)return;const imageAbsoluteUrl=new URL(imageRawUrl,href).href;const{ok,url}=await fetch(imageAbsoluteUrl);if(ok)setImage(url)},FETCH_DELAY);return()=>clearTimeout(timer)},[href]);return{image,title,description}}